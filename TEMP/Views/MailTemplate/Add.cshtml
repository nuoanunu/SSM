@model SSM.ViewModels.CreateEmailTemplateViewModel

@{
    ViewBag.Title = "Home Page";
}

<script src="~/Scripts/tinymce/jquery.tinymce.min.js"></script>
<script src="~/Scripts/tinymce/tinymce.min.js"></script>



<h2>Create Email Template</h2>
@using (Html.BeginForm("Save", "MailTemplate", FormMethod.Post, new { id = "submitform" }))
{
    @Html.ValidationSummary(true, "Please fix the following errors")
    <div class="form-group">
        @Html.LabelFor(m => m.EmailTemplateEntity.Name, new { @class = "required" })
        @Html.TextBoxFor(m => m.EmailTemplateEntity.Name, new { @class = "form-control" })
        @Html.ValidationMessageFor(m => m.EmailTemplateEntity.Name)
    </div>
    <div class="form-group">
        @Html.LabelFor(m => m.EmailTemplateEntity.EmailCategoryId, new { @class = "required" })
        @Html.DropDownListFor(m => m.EmailTemplateEntity.EmailCategoryId, new SelectList(Model.EmailCategories, "id", "Name"), "", new { @class = "form-control" })
        @Html.ValidationMessageFor(m => m.EmailTemplateEntity.EmailCategoryId)
    </div>

    //Mail Content
    <textarea></textarea>

    <div class="form-group">
        @Html.HiddenFor(m => m.EmailTemplateEntity.id)
        @Html.HiddenFor(m => m.EmailTemplateEntity.MailContent, new { @class = "form-control" })
        @Html.ValidationMessageFor(m => m.EmailTemplateEntity.MailContent)
    </div>

        @Html.AntiForgeryToken()
        <button type="submit" class="btn btn-primary" id="buttonSend">Save</button>
}
       


<script>
    $(document).ready(function () {
        tinymce.init({
            //selector: 'textarea#editext' + stepno,
            selector: 'textarea',
            height: 250,
            plugins: [
              'advlist autolink lists link image charmap print preview anchor',
              'searchreplace visualblocks code fullscreen',
              'insertdatetime media table contextmenu paste code'
            ],
            toolbar: 'insertfile undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image',
            content_css: '//www.tinymce.com/css/codepen.min.css'
        });       

        //Check mail content not null and assign value of text area tag to hidden field mail content
        $('#buttonSend').click(function (e) {
            var content = tinyMCE.activeEditor.getContent();
            
            //check null not working, validate in server
            if (content == undefined || content == null) {
                alert("Please enter mail content!");
                e.preventDefault();
                e.stopImmediatePropagation();
            }
            else {
                $('#EmailTemplateEntity_MailContent').val(tinyMCE.activeEditor.getContent());
                this.submit();
            }
        });
    });
</script>

 @section scripts
{
    @Scripts.Render("~/bundles/jqueryval")
}

@*Reference*@
<script>
    //$("#buttonSend").on("click", function () {
    //    //alert(tinyMCE.activeEditor.getContent());
    //    $('#EmailTemplateEntity_MailContent').val(tinyMCE.activeEditor.getContent());
    //    //alert($('#EmailTemplateEntity_MailContent').val());
    //});

    //$('#submitform').on('submit', function (e) {

    //    var content = tinyMCE.activeEditor.getContent();
    //    alert("content la" + content);
    //    if (content == undefined || content == null) {
    //        alert("Please enter mail content!");
    //        e.preventDefault();
    //        e.stopImmediatePropagation();
    //    }
    //    else {
    //        $('#EmailTemplateEntity_MailContent').val(tinyMCE.activeEditor.getContent());
    //        this.submit();
    //    }
    //});
</script>


