@using SSM.Models;
<script src="~/Scripts/jquery-1.10.2.min.js"></script>
<style>
    @@font-face {
        font-family: 'Roboto-Light';
        src: url("../../fonts/Roboto-Light.ttf") format('truetype');
    }

    @@font-face {
        font-family: 'Roboto-Black';
        src: url("../../fonts/Roboto-Black.ttf") format('truetype');
    }
</style>
<script src="//code.jquery.com/jquery-1.12.3.js"> </script>
<script src="https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min.js"> </script>
<script src="https://cdn.datatables.net/1.10.12/js/dataTables.bootstrap.min.js"> </script>
<link href="https://cdn.datatables.net/1.10.12/css/dataTables.bootstrap.min.css" rel="stylesheet" />
<script>

</script>
<h1> <font style="font-family:Roboto-Light"> Product Detail</font> </h1>
@if (ViewData["productDetail"] != null)
{
    softwareProduct product = (softwareProduct)ViewData["productDetail"];
    string[] screenshots = product.screenShots.ToString() .Split(new[] { ";" }, StringSplitOptions.RemoveEmptyEntries);
        <div class="row">
            <div style="padding:0"  class="col-md-3">
                <img style="padding:0;vertical-align: top;" height="300dp" src="@product.screenShots" />
            </div>
            <div style="padding:0"  class="col-md-3">
                <table width="100%" style="border: 2px solid  #eeeeee;" height="600dp">
                    <tr>
                        <th colspan="2" align="center" style="background-color:aqua;text-align: center;">
                           <h3 style="vertical-align: top;"><font style="font-family:Roboto-Light">Product information</font></h3> 
                        </th>
                    </tr>
                    <tr style="border: 2px solid  #eeeeee;">
                        <td align="left">
                            Product Name:
                        </td>
                        <td align="right">
                            @product.name
                        </td>
                    </tr>
                    <tr style="border: 2px solid  #eeeeee;">
                        <td align="left">
                            SKU:
                        </td>
                        <td align="right">
                            @product.SKU
                        </td>
                    </tr>
                    <tr style="border: 2px solid  #eeeeee;">
                        <td align="left">
                            Short Description:
                        </td>
                        <td align="right">
                            @product.shortDescription
                        </td>
                    </tr>
                    <tr style="border: 2px solid  #eeeeee;">
                        <td align="left">
                            Full Description:
                        </td>
                        <td align="right">
                            @product.fullDescription
                        </td>
                    </tr>
                    <tr style="border: 2px solid  #eeeeee;">
                        <td align="left">
                            Screen Shots
                        </td>
                        <td align="right">
                            @foreach (string img in screenshots) {
                                <img style="padding:0;vertical-align: top;" width="100dp" src="@img" />
                            }
                           
                        </td>
                    </tr>
                </table>
            </div>
            <div style="padding:10;max-height:600px;height:600px;" class="col-md-6 pre-scrollable">
                <div class="container" style="width:100dp">
                    <table id="myData" class="table table-striped table-bordered" cellspacing="0" width="100%">
                        <tr style="background-color:coral;text-align: center;">
                            <th width="25%" align="center" height="116.67dp" style="text-align:center;">
                                <h3 style="vertical-align: top;"><font style="font-family:Roboto-Light">Attribute name</font></h3>
                            </th>
                            <th width="25%" align="center" style="text-align:center;">
                                <h3 style="vertical-align: top;"><font style="font-family:Roboto-Light"> Code</font></h3>
                            </th>
                            <th width="25%" align="center" style="text-align:center;">
                                <h3 style="vertical-align: top;"><font style="font-family:Roboto-Light"> Available Options</font></h3>
                            </th>

                            <th width="25%" align="center" style="text-align:center;">
                                <h3 style="vertical-align: top;"><font style="font-family:Roboto-Light">   Action</font></h3>
                            </th>
                        </tr>
                        @foreach (productAttribute pattr in product.productAttributes)
                        {
                            String mymodelid = "optionmodal" + pattr.id;
                            <tr>
                                <td height="75dp" width="25%">
                                    @pattr.name
                                </td>
                                <td width="25%">
                                    @pattr.code

                                </td>
                                <td width="25%">
                                    @pattr.attributeOptions.ToList().Count()
                                </td>
                                <td width="25%">

                                    <button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#@mymodelid">Open Large Modal</button>
                                    <div class="modal fade" id="@mymodelid" role="dialog" >
                                        <div class="modal-dialog">

                                            <!-- Modal content-->
                                            <div class="modal-content" style="width:800px">
                                                <div class="modal-header">
                                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                                    <h4 class="modal-title"> @pattr.name Detail</h4>
                                                </div>
                                                <div class="modal-body">
                                                    <p>@pattr.name</p>
                                                    <p>@pattr.description</p>
                                                    <h4>Options</h4>
                                                    <table class="table table-striped table-bordered" width="100%" id="@(pattr.id+  "OptTable")">
                                                        <tr>
                                                            <th>
                                                                Option Name
                                                            </th>
                                                            <th>
                                                                Option Description
                                                            </th>
                                                            <th>
                                                                Price
                                                            </th>
                                                            <th>
                                                                Action
                                                            </th>
                                                        </tr>
                                                        <tbody>
                                                            @foreach (attributeOption attopt in pattr.attributeOptions.ToList())
                                                            {
                                                                <tr>
                                                                    <td>
                                                                        @attopt.name
                                                                    </td>
                                                                    <td>
                                                                        @attopt.description
                                                                    </td>
                                                                    <td>
                                                                        @attopt.price
                                                                    </td>
                                                                    <td>
                                                                        <button>Edit</button>
                                                                    </td>

                                                                </tr>
                                                            }
                                                            <tr>
                                                                <input type="hidden" id="@(pattr.id+  "NewOptAttID")" value="@pattr.id" />
                                                                <td>
                                                                    <input type="text" id="@(pattr.id+  "NewOptName")" />
                                                                </td>
                                                                <td>
                                                                    <input type="text" id="@(pattr.id+  "NewOptDes")" />
                                                                </td>
                                                                <td>
                                                                    <input type="text" id="@(pattr.id+  "NewOptPrice")" />
                                                                </td>
                                                                <td>
                                                                    <button id="@(pattr.id+  "NewBtn")">Add</button>
                                                                </td>
                                                                <script>
                                                                    $('#@(pattr.id+  "NewBtn")').click(function () {
                                                                        $('#@(pattr.id+  "OptTable") tbody').append('<tr class="child"><td></td><td></td><td></td></tr>');
                                                                    });
                                                                </script>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                                <div class="modal-footer">
                                                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                                                </div>
                                            </div>

                                        </div>
                                    </div>


                                </td>
                            </tr>

                        }
                    </table>
                </div>

            </div><!-- end row -->
        </div><!-- end container -->

    <div>
        
    </div>
    <div>
        <table id="myData" class="table table-striped table-bordered" cellspacing="0">
            <tr>
                <th>
                    Plan name
                </th>
                <th>
                    Created Date
                </th>
                <th>
                    Description
                </th>
                <th>
                    Number of steps
                </th>
                <th>
                    Action
                </th>
            </tr>
            @foreach (PrePurchase_FollowUp_Plan plan in product.PrePurchase_FollowUp_Plan)
            {   String corlor = "#ffffff";
                if (plan.isActive) {
                    corlor = "#98FB98";
                }

                <tr style="background-color:@corlor">


                    <td>
                        @plan.name
                    </td>
                    <td>
                        @plan.createDate
                    </td>
                    <td>
                        @plan.Description
                    </td>
                    <td>
                        @plan.Plan_Step.ToList().Count()
                    </td>
                    <td>
                        <button>Edit</button>
                    </td>
                </tr>
            }
        </table>
        <button type="button" onclick="redirectToNewPlan()" class="btn btn-info btn-lg" >+New Plan</button>
    </div>
    <script>
        function redirectToNewPlan() {
            window.location = "/Product/NewPlan";
        }
    </script>
}